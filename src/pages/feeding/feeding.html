<ion-header>
  <ion-navbar no-border-bottom color="navbarColor">
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title> Feeding </ion-title>
  </ion-navbar>

  <!-- SEGMENT BEGINS -->
  <ion-toolbar>
    <ion-segment [(ngModel)]="segmentType">
      <ion-segment-button value="Breast">
        Breast
      </ion-segment-button>
      <ion-segment-button value="Bottle">
        Bottle
      </ion-segment-button>
      <ion-segment-button value="Meal">
        Meal
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>


<ion-content no-border-top>
  <!-- This is where you can do individual things inside the segments -->
  <div [ngSwitch]="segmentType">
    <!-- Brestfeeding segment starts here -->
    <ion-list *ngSwitchCase="'Breast'">
      <ion-row no-padding class="other-data">
        <ion-col no-padding class="column">
          <button ion-button full [class.activeHighlight]="leftBreast" [disabled]="!timer.isPaused" color="light" (click)="setLeftBreast()">
            Left Breast
          </button>
        </ion-col>
        <ion-col no-padding class="column">
          <button ion-button full [class.activeHighlight]="rightBreast" [disabled]="!timer.isPaused" color="light" (click)="setRightBreast()">
            Right Breast
          </button>
        </ion-col>
      </ion-row>
      <p class="center"  *ngIf="lastBreastFeed;else none">
        <i class="momentsAgo"><b>Last breastfeed: about {{momentsAgo}}</b></i>
        <br>
        <i> {{lastBreastFeed}} on {{lastBreastSide}} </i>
        <br>
        <i> duration: {{((lastDuration) |  hoursMinutesSeconds:{hours: true, minutes: true, seconds: true})}} </i>
      </p>
      <ng-template #none>
        <p class="center">
          <i>Last breastfeeding: No records of breastfeeding yet! </i>
        </p>
      </ng-template>
      <br>
      <!-- Timer for breastfeeding starts here -->
      <h2> {{((timer.tick) | hoursMinutesSeconds:{hours: true, minutes: true, seconds: true})}} </h2>
      <br><br>
      <div class="center">
        <button class="timer" ion-button icon-only [disabled]="!timer.tick || !timer.isPaused" (click)="refreshTimer()">
          <ion-icon name='refresh'></ion-icon>
        </button>
        <button class="timer" ion-button icon-only (click)="startPauseTimer()">
          <ion-icon [name]="timer.isPaused ? 'play' : 'pause' "></ion-icon>
        </button>
        <button class="timer" ion-button icon-only [disabled]="!timer.tick || !timer.isPaused" (click)="saveBreastFeeding()">
          <ion-icon name='archive'></ion-icon>
        </button>
      </div>
      <ion-footer no-border-top no-border-bottom>
        <ion-row no-padding class="other-data">
          <ion-col no-padding class="column">
            <button ion-button full color="light" (click)="getBfHistory()">
              History
            </button>
          </ion-col>
          <ion-col no-padding class="column">
            <button ion-button full color="light" (click)="manualAddBreastFeed()">
              Manually Add
            </button>
          </ion-col>
        </ion-row>
      </ion-footer>
    </ion-list>

    <!-- Bottle feeding starts here -->
    <ion-list *ngSwitchCase="'Bottle'">
      <!-- Add With timer-->
      <div id="block_container">
        <form name="bottleFeeding" (ngSubmit)="saveBottleFeeding()">
          <div class="box">
            <ion-item>
              <ion-label>Type:</ion-label>
              <ion-select [(ngModel)]="bottle.type" name="type" interface="popover">
                <ion-option selected="true" value="Formula">Formula</ion-option>
                <ion-option value="Breast">Breast</ion-option>
                <ion-option value="Milk">Milk</ion-option>
              </ion-select>
            </ion-item>
            <ion-item>
              <ion-label>Volume: </ion-label>
              <ion-input placeholder="__" type="number" [(ngModel)]="bottle.volume" name="volume"></ion-input>
              <ion-select [(ngModel)]="bottle.unit" name="unit" interface="popover">
                <ion-option selected="true" value="oz">oz</ion-option>
                <ion-option value="ml">ml</ion-option>
              </ion-select>
            </ion-item>
            <ion-item>
              <ion-label color="gray!important">Notes:</ion-label>
              <p item-right (click)="noteAlert()">
                <ion-icon name="clipboard"></ion-icon>
                <ion-icon *ngIf="bottleNote" color="green" name="checkmark"></ion-icon>
              </p>
            </ion-item>
          </div>
        </form>
      <!-- Timer for bottle -->
        <div class="box-right">
          <br>
          <h3> {{((timer.tick) | hoursMinutesSeconds:{hours: true, minutes: true, seconds: true})}} </h3>
          <br>
          <div class="center">
            <button class="timer" ion-button icon-only [disabled]="!timer.tick || !timer.isPaused" (click)="refreshTimer()">
              <ion-icon name='refresh'></ion-icon>
            </button>
            <button class="timer" ion-button icon-only [disabled]="durationIsSet" (click)="startPauseTimer()">
              <ion-icon [name]="timer.isPaused ? 'play' : 'pause' "></ion-icon>
            </button>
            <button class="timer" ion-button type="submit" icon-only [disabled]="!timer.isPaused" (click)="saveBottleFeeding()">
              <ion-icon name='archive'></ion-icon>
            </button>
            <button class="timer" ion-button icon-only (click)="manuallyAddBottle()">
              <ion-icon name="add"></ion-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <p class="center"  *ngIf="lastBottleFeed;else none">
        <i class="momentsAgo"><b>Last bottlefeed: about {{BottleMomentsAgo}}</b></i>
        <br>
        <i> {{lastBottleFeed}}, {{this.bottleLastAmount}}</i>
        <br>
        <i>{{((lastBottleDuration) |  hoursMinutesSeconds:{hours: true, minutes: true, seconds: true})}} </i>
      </p>
      <ng-template #none>
        <p class="center">
          <i>Last bottlefeed: No records of bottlefeeding yet! </i>
        </p>
      </ng-template>

      <!-- NOTE: Summary of bottlefeeding -->
      <!-- <ion-scroll scrollY="true" overflow-scroll="false">
      <div> -->
      <div class="bottle-summary">
        <div *ngIf="hasToday">
          <div class="divider-title"> Today </div>

          <ul class="timeline">
            <li *ngFor="let x of todayHistoryArray">
              <div >
                <p class="timeline-item"> {{x}}</p>
              </div>
            </li>
          </ul>
        </div>

        <div *ngIf="hasYesterday">
          <div class="divider-title"> Yesterday </div>
          <ul class="timeline">
            <li *ngFor="let x of yesterdayHistoryArray">
              <div>
                <p class="timeline-item"> {{x}}</p>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div *ngIf="hasMore">
        <ion-item-group *ngFor="let x of moreHistoryArray | groupby: 'date'">
          <div  class="divider-title">
            {{ x.key | moment:'ll' }}
          </div>
          <ul class="timeline">
            <li *ngFor="let event of x.list">
              <div>
                <p class="timeline-item"> {{event.output}} </p>
              </div>
            </li>
          </ul>
        </ion-item-group>
      </div>
      <!-- </div> -->
      <!-- </ion-scroll> -->

    </ion-list>



    <!-- Meal feeding starts here -->
    <ion-list *ngSwitchCase="'Meal'">
      <p> do something here 3 </p>
    </ion-list>

  </div>

</ion-content>
